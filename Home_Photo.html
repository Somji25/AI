<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../static/style2.css">
    <title>หน้าแรก</title>
    <style>
        /* กำหนดขนาดสูงสุดให้กับภาพที่แสดง */
        #image-display {
            max-width: 300px; /* กำหนดความกว้างสูงสุด */
            max-height: 300px; /* กำหนดความสูงสูงสุด */
            object-fit: contain; /* ปรับให้ภาพไม่บิดเบี้ยว */
        }
    </style>
</head>
<body>
    <header>
        <nav class="navigation">
            <a href="Home.html">Home</a>
            <a href="../TEST/TEST1.html">WebCam</a>
            <a href="about.html">About</a>
        </nav>
    </header>
    <h1>Photo Detection</h1>

    <form id="upload-form" method="POST" action="{{ url_for('predict') }}" enctype="multipart/form-data">
        <input type="file" name="image" accept="image/*" required id="file-input">
        <button type="submit">Import</button>
    </form>

    <div id="uploaded-image" style="display:none;">
        <h2>Photo Import</h2>
        <img id="image-display" src="" alt="Uploaded Image">
    </div>

    <div id="prediction-result" style="display:none;">
        <h2>ผลการทำนาย:</h2>
        <p id="predicted-letter"></p>
        <p id="confidence"></p>
    </div>

    <script>
        const fileInput = document.getElementById("file-input");
        const imageDisplay = document.getElementById("image-display");
        const uploadedImageDiv = document.getElementById("uploaded-image");
        const predictionResultDiv = document.getElementById("prediction-result");

        // แสดงภาพที่ถูกเลือกก่อนอัปโหลด
        fileInput.onchange = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    imageDisplay.src = event.target.result;
                    uploadedImageDiv.style.display = 'block';

                    // รีเซ็ตผลการทำนาย
                    predictionResultDiv.style.display = 'none';
                    document.getElementById("predicted-letter").innerText = '';
                    document.getElementById("confidence").innerText = '';
                };
                reader.readAsDataURL(file);
            } else {
                uploadedImageDiv.style.display = 'none';
                predictionResultDiv.style.display = 'none'; // ซ่อนผลการทำนายเมื่อไม่มีไฟล์
            }
        };

        document.getElementById("upload-form").onsubmit = function(event) {
            event.preventDefault();
            const formData = new FormData(this);

            fetch(this.action, {
                method: this.method,
                body: formData,
            })
            .then(response => response.json())
            .then(data => {
                if (data.predicted_letter) {
                    document.getElementById("predicted-letter").innerText = `ตัวอักษรที่ทำนาย: ${data.predicted_letter}`;
                    document.getElementById("confidence").innerText = `ความมั่นใจ: ${data.confidence.toFixed(2)}%`;
                    predictionResultDiv.style.display = 'block';
                }
            })
            .catch(error => console.error('Error:', error));
        };
    </script>
</body>
</html>
